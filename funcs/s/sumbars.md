# calculate the turnover period
id = `A`A`B`A`C`B`A`C`A`B
time = 2022.01.01T09:00:00 + 0..9
volume = 100 150 80 120 220 200 180 90 100 125
t = table(id, time, volume)
capital = 300
re = select *, sumbars(volume, capital) as period from t
re;
```

| id | time | volume | period |
| --- | --- | --- | --- |
| A | 2022.01.01T09:00:00 | 100 | 0 |
| A | 2022.01.01T09:00:01 | 150 | 0 |
| B | 2022.01.01T09:00:02 | 80 | 3 |
| A | 2022.01.01T09:00:03 | 120 | 3 |
| C | 2022.01.01T09:00:04 | 220 | 2 |
| B | 2022.01.01T09:00:05 | 200 | 2 |
| A | 2022.01.01T09:00:06 | 180 | 2 |
| C | 2022.01.01T09:00:07 | 90 | 3 |
| A | 2022.01.01T09:00:08 | 100 | 3 |
| B | 2022.01.01T09:00:09 | 125 | 3 |

