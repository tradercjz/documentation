# fy5253Quarter

## 语法

`fy5253Quarter(X, [weekday=0], [startingMonth=1],
[qtrWithExtraWeek=1], [nearest=true], [offset], [n=1])`

## 参数

**X** 可以是 DATE, DATETIME, TIMESTAMP 或 NANOTIMESTAMP
类型的标量或向量。

**weekday** 是0到6之间的整数，表示星期编号。0表示星期一，1表示星期二，... ，6表示星期日。默认值为0。

**startingMonth** 是1到12之间的整数，表示一年的起始月份。默认值是1。

**qtrWithExtraWeek** 是1到4之间的整数。如果有闰季（一般一个季度有13周，闰季有14周），它表示闰季所在的季度。

**nearest** 是一个布尔值。默认值为 true。

**offset** 是与 *X* 类型相同的标量，并且它必须小于等于 *X*
中的最小值。它是一个可选参数。如果没有指定，*offset* 默认为 *X* 中的最小值。

**n** 是一个正整数。它是一个可选参数，默认值为1。

## 详情

采用52-53周财年（4-4-5历），该函数返回X所在财政季度的起始日期。

* 如果 *nearest*=true，表示将最接近 *startingMonth* 最后一天的
  *weekday* 的日期作为财政年度的起始日期。
* 如果 *nearest*=false，表示将 *startingMonth* 中最后一个
  *weekday* 的日期作为财政年度的起始日期。

如果指定了 *offset*，表示从 *offset* 开始，结果每隔 *n*
个季度更新一次。注意，只有当 *n*>1 时，*offset* 才会生效。

## 例子

```
fy5253Quarter(2019.12.01,0,1,1,true);
// output
2019.11.04

fy5253Quarter(2019.12.01,0,1,4,true);
// output
2019.10.28
// 2019年的财年起始日期是2019.01.28，2020年的财年起始日期是2020.02.03，两者相差53周，说明有一个闰季。qtrWithExtraWeek=1表示第一个季度为闰季，它包含14周，因此2019.12.01所在季度的起始日期为2019.11.01；qtrWithExtraWeek=4表示第4个季度为闰季，它包含14周，因此2019.12.01所在季度的起始日期是2019.10.28。

date=2016.01.12 2016.02.25 2016.05.12 2016.06.28 2016.07.10 2016.08.18 2016.09.02 2016.10.16 2016.11.26 2016.12.30
time = [09:34:07,09:36:42,09:36:51,09:36:59,09:32:47,09:35:26,09:34:16,09:34:26,09:38:12,09:38:13]
sym = take(`MSFT,10)
price= 49.6 29.46 29.52 30.02 174.97 175.23 50.76 50.32 51.29 52.38
qty = 2200 1900 2100 3200 6800 5400 1300 2500 8800 4500
t1 = table(date, time, sym, qty, price);

select avg(price),sum(qty) from t1 group by fy5253Quarter(date,0,1,1,true,2016.01.01,2);
```

| fy5253Quarter\_date | avg\_price | sum\_qty |
| --- | --- | --- |
| 2015.11.02 | 39.53 | 4100 |
| 2016.05.02 | 85.136667 | 21300 |
| 2016.10.31 | 51.835 | 13300 |

相关函数：[fy5253](fy5253.md)

