# 3.00.2

## 新功能

* 支持多资产回测模式下的期权行权操作。**（3.00.2.13）**
* 支持回测引擎使用扩展行情字段，并放宽非 JIT 模式下对行情数据列顺序的要求。**（3.00.2.13）**
* 新增配置项 *outputSeqNum*，用于在订单成交明细表中返回序列号。**（3.00.2.13）**
* 新增函数 `getBacktestStat`，用于获取回测引擎状态信息。**（3.00.2.13）**
* 新增支持多账户回测，支持股票、期货、期权账户。**（3.00.2.11）**
* 期货 onOrder 回调函数参数 *orders* 新增 symbolSource 键。**（3.00.2.11）**
* 多账户、股票、两融品种回测支持拓展字段及任意行情字段顺序。**（3.00.2.11）**
* 期货回测品种 `onOrder` 回调函数中 *orders* 新增支持 symbolSource
  字段。

  **（3.00.2.9）**
* 股票、两融回测品种的权益表中增加 frozenFunds 冻结资金字段。

  **（3.00.2.9）**
* 股票支持设置底仓。**（3.00.2.8）**
* 回测数字货币品种支持 JIT 模式。 **（3.00.2.8）**
* 回测两融品种支持 JIT 模式。 **（3.00.2.8）**
* 新增支持 onTimer 回调函数。**（3.00.2.8）**
* 新增支持上交所债券。**（3.00.2.6）**
* 股票、期货、期权、债券回测支持在成交明细中显示拒单原因。**（3.00.2.6）**
* 期权回测支持持仓在最后交易日自动清算。**（3.00.2.4）**
* 两融回测支持见价成交模式。**（3.00.2.4）**
* 新增数字货币的快照行情回测功能。**（3.00.2.3）**
* 股票高频回测时，新增支持订单有效性的算法订单。**（3.00.2.3）**
* 新增股票、两融、期权期货的模拟交易模式。**（3.00.2.3）**
* 新增 strategyGroup 类型通用品种 ”universal” 。**（3.00.2.3）**
* 新增支持实时回调行情函数、推送日志、获取成交明细等回测结果 **（3.00.2.3）**
* 新增接口 subscribeIndicator 中的行情类型名称 ohlc 、snapshot\_ohlc ，并兼容 kline 及
  snapshot\_kline。**（3.00.2.3）**
* 新增回测引擎的接口：getStockTotalPortfolios、getFuturesTotalPortfolios、getOptionTotalPortfolios、setBacktestMode。**（3.00.2.3）**
* 新增股票期权期货的 snapshot 行情合成 Bar 行情，并支持同时回调 onBar 和 onSnapshot。**（ 3.00.2.1）**
* 新增支持见价成交的撮合 ，不需要发送订单至模拟撮合引擎。**（ 3.00.2.1）**
* 新增支持期货的算法订单，新增期货的引擎配置项 enableAlgoOrder、futuresType。**（ 3.00.2.1）**
* 新增通过回测引擎配置项，实现指标计算时相应行情的时间列的添加。**（ 3.00.2.1）**
* 新增引擎配置项：如 isBacktestMode、context、addTimeColumnInIndicator。**（ 3.00.2.1）**
* 新增行情回调函数统一参数 indicator，为订阅指标计算的结果。**（
  3.00.2.1）**
* 新增回测引擎的接口：如
  createBacktester、createUserOrder、setTradingOutput、genIndicatorSchema。**（ 3.00.2.1）**
* 新增股票的逐笔（宽表）以及逐笔+快照（宽表）的行情类型。**（ 3.00.2.1）**
* 新增数字货币回测引擎，支持数字货币分钟频以及日频回测。**（ 3.00.2.1）**
* 新增回测的 JIT 模式 。**（ 3.00.2.1）**

## 功能优化

* 多账户回测引擎的策略名称修改为 multiAsset。**（3.00.2.13）**
* 优化配置项和基础信息表的报错提示。**（3.00.2.13）**
* 增强融资融券回测的仓底正确性检查。**（3.00.2.6）**
* 优化指标计算功能的性能，批量插入数据时耗时提升。 **（3.00.2.3）**
* 优化行情类型 msg 字典传入的回测性能。**（3.00.2.3）**
* 优化一些报错信息提示。**（3.00.2.3）**

## 缺陷修复

* 修复期权回测过程中无法识别订阅指标元代码中变量的问题。**（3.00.2.13）**
* `getMarginBuyPosition` 接口返回的 buyValue 有误。**（3.00.2.11）**
* `getReturnSummary` 接口实时计算特定情况有误。**（3.00.2.11）**
* 股票分红除权的配股逻辑有误。**（3.00.2.11）**
* 修复接口 `getAvailableCash` 返回可用资金不准确的问题。

  **（3.00.2.9）**
* 修正 `getAvailableCash` 接口逻辑。**（3.00.2.8）**
* 修复 `createBacktester` 创建的回测引擎在调用
  `getPortfolios` 接口时返回表而非字典的问题。**（3.00.2.8）**
* 修复在未设置 `onTransaction` 回调函数时，上交所债券品种抛出异常的问题。**（3.00.2.8）**
* 修复两融回测引擎当可用资金为负时，资金、盈亏等结果错误的问题。（3.00.2.7）
* 修复 onOrder 回调函数中撤单立即响应导致递归调用的问题。（3.00.2.7）
* 两融回测实时获取的可用现金不包含冻结资金。**（3.00.2.4）**
* 股票 submitOrder 提交深交所订单且类型为 4 时的报错问题。**（3.00.2.3）**
* 股票 onSnapshot 中提交多标的订单，实际会有部分标的缺失。**（3.00.2.3）**
* 股票买开价格大于涨停价，未拒单的问题。**（3.00.2.3）**
* 股票分钟频，分红除权、现金、持仓计算错误。**（3.00.2.3）**
* 股票订阅逐笔行情的回测结果不正确性。**（3.00.2.3）**
* 两融、期权的回测结果不正确性。**（3.00.2.3）**
* 接口 `getReturnSummary` 在设置 benchmark 时的 beta、alpha
  字段计算错误。**（3.00.2.3）**
* 修复 bar 行情的指标计算 bug。**（3.00.2.3）**
* 修复见价成交 bug。**（3.00.2.3）**
* 修复一些报错 bug。**（3.00.2.3）**
* 接口 `getPosition` 买卖成交均价的字段计算错误。**（3.00.2.1）**
* 接口 `getReturnSummary` 日胜率的字段计算错误。**（3.00.2.1）**

