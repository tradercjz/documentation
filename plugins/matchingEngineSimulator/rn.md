# 版本说明

## 3.00.3

### 新功能

* `createMatchEngine` 函数的 *config* 参数支持配置
  outputSeqNum，用于在订单明细表中输出序列号。（**3.00.3.1**）

### 功能优化

* 模拟撮合引擎支持插入可变市场深度的期货快照、股票快照数据，自动适应实际市场数据的深度。（**3.00.3.1**）

## 3.00.2

### 新功能

* `createMatchEngine` 函数的 *config* 参数支持配置
  outputSeqNum，用于在订单明细表中输出序列号。（**3.00.2.13**）
* 新增 *tradeInLots* 配置，用于设置银行间债券品种的最小交易量。（**3.00.2.9**）
* 新增支持 `MatchingEngineSimulator::version()`
  函数，用于获取当前模拟撮合插件的版本号。（**3.00.2.4**）
* 新增支持上交所债券。（**3.00.2.3**）
* 银行间现券支持 FAK 和 FOK 订单类型。（**3.00.2.3**）
* 银行间现券快照支持配置项
  immediateOrderConfirmation、immediateCancel，用来设置是否立即返回委托回报和撤单。（**3.00.2.2**）
* 新增方法 `dropMatchingEngine`，用于停止模拟撮合引擎。（**3.00.2.1**）
* 新增配置项 outputOrderTradeFlag，支持输出吃单、挂单标志。（**3.00.2.1**）
* 新增数据类别，支持对数字货币分钟频、日频数据进行模拟撮合。
* 接口 `createMatchEngine` 新增配置项
  *orderByPrice*，支持在银行间现券模式下基于 XBond 的 tick 行情模拟撮合到期收益率。
* 接口 `createMatchEngine` 新增配置项
  *userDefinedOrderId*，支持在订单详情结果输出表中输出用户自定义的委托订单号（userOrderId）。
* 当模拟撮合期货数据时，若 `exchange="universal"`
  （开启通用模式），输入的行情和用户订单、`getOpenOrders`
  返回表、订单详情结果输出表中的价格类数据精确到小数点后 5 位。

### 功能优化

* 模拟撮合引擎支持插入可变市场深度的期货快照、股票快照数据，自动适应实际市场数据的深度。（**3.00.2.13**）
* 银行间现券和上交所债券增加限制委托数量和成交数量的规则。（**3.00.2.7**）
* 创建模拟撮合引擎时，当 *config* 的 dataType 设置为股票逐笔（0）时，支持设置 latency=-1。（**3.00.2.5**）
* 优化即时撮合逻辑。（**3.00.2.3**）
* 银行间现券快照的 DOUBLE 类型数据支持精确到小数点后 5 位。（**3.00.2.2**）
* 数字货币快照支持插入不同长度的快照行情。（**3.00.2.2**）
* 支持在行情数据里的 array vector 类型的档位里填入空值，表示该档位为空。（**3.00.2.2**）
* 调用 `setLimitPrice` 时，若设置 upLimitPrice 为 0，则表示涨停价无限制。 （**3.00.2.2**）

### 故障修复

* 在处理银行间现券和上交所债券的双边订单时，系统显示的成交状态不正确。（**3.00.2.6**）
* 对模拟撮合引擎进行并发操作导致 server 崩溃。（**3.00.2.4**）
* 当设置 latency=-1 时，如果插入用户限价单时没有行情数据，该订单会被直接拒单。（**3.00.2.4**）
* 在模拟撮合中，仅插入行情数据且没有用户订单时，调用 `getOpenOrders` 函数并指定
  *symbolList* 会导致服务器崩溃。（**3.00.2.4**）
* 分钟频和日频填入错误订单类型的订单（包含 0：市价单、5：限价单、6：撤单）未如预期执行拒单。
* 股票快照模式二和银行间现券模式中，若当前成交列表数量超过 20000 个时会报错。现已取消上限。

## 3.00.1

### 新功能

* 模拟撮合银行间现券模式中，订单详情结果输出表增加字段 yield（到期收益率）。（**3.00.1.5**）
* `createMatchEngine` 接口中参数 *config* 的键值
  orderBookMatchingRtio 取消上限。

### 功能优化

* 期货期权类型新增支持撮合 universal 类型数据（无交易时间限制）。（**3.00.1.2**）
* 行情涨停价为 0 时，期货期权的市价单会以 10 倍的最新价进行委托。（**3.00.1.2**）

### 故障修复

* 可转债未规定成交量须为 10 的倍数的限制。（**3.00.1.1**）
* 填入空字符串的标的用户订单时没有拒单。（**3.00.1.1**）
* 使用模拟撮合模式二时预分配了过多的内存。（**3.00.1.1**）

## 3.00.0

### 新功能

* 在对科创版股票进行模拟撮合的日频模式中，取消对用户订单的委托数量的上限。（**3.00.0.3**）
* 支持对期货类型数据进行模拟撮合。（**3.00.0.2**）
* 支持股票上交所保护限价的市价单。（**3.00.0.2**）
* 新增配置项 *outputRejectDetails*，支持获取用户订单的拒单信息。（**3.00.0.2**）
* 支持配置参数 *latency* 为 -1 时，即时撮合用户订单。（**3.00.0.2**）
* `resetMatchingEngine` 增加可选参数
  *cancelOrder*，支持撤销用户订单并将撤单信息写入到订单输入列表。（**3.00.0.2**）
* 增加了股票数据（逐笔和快照）的集合竞价逻辑。
* 接口 `createMatchEngine` 新增参数
  *outputOrderConfirmation*，用于输出委托回报。
* 支持判断上交科创版股票的用户订单类型。
* 支持判断可转债的用户订单类型。

### 功能优化

* 股票和期货在中低频的模拟撮合中，涨停卖出、跌停买入被拒单。（**3.00.0.3**）
* 修改股票的开盘竞价逻辑。（**3.00.0.2**）
* 参考沪深行情的最新数据字段修订了相关的接口命名。
* 行情为股票逐笔类型时，提升了单行数据写入的性能和用户订单的撮合性能。
* 修改 *latency*（延时）大于 0 时用户委托订单的撮合时间条件的计算规则。
* 将用户实际撤单时间调整为撤单请求时间与延迟时间之和 。
* 将实际的拒单时间调整为行情时间之后。

### 故障修复

* 逐笔撮合多条用户订单时撮合结果错误。
* 逐笔撮合时计算逐笔数据的全额成交没有包含全部行情数据。

