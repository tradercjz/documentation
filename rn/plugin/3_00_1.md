# 3.00.1

## amdQuote

### 新功能

* 新增支持订阅北交所股转快照数据。**（3.00.1.6）**
* 新增函数 `setLogLevel`用于设置插件输出日志的等级，同时新增函数
  `getLogLevel`，用于获取插件当前的输出日志等级。**（3.00.1.6）**

### 功能优化

* 新增支持配置与监控订阅队列的深度（**3.00.1.10**）：

  + `subscribe` 新增参数
    *queueDepth*，支持设置订阅队列的深度。
  + `getStatus` 支持获取当前订阅队列的深度。

## Arrow

### 缺陷修复

任务执行过程中若发生续传，可能会出现任务卡住。（**3.00.1.10**）

## Backtest

### 新功能

新增期权回测引擎，支持期权业务逻辑。**（3.00.1.1）**

### 功能优化

优化期货回测在快照模式下的性能，并修改部分接口。**（3.00.1.3）**

### 故障修复

* 部分计算逻辑和计算 bug 。**（3.00.1.3）**
* 股票、期货、期权平仓时持仓数量检查错误。**（3.00.1.3）**
* 部分计算逻辑和计算 bug 。**（3.00.1.1）**

## EFH

### 新功能

* 新增支持上交所逐笔合并数据。**（3.00.1.8）**

## EncoderDecoder

### 功能优化

* 支持解析 protobuf 的枚举类型（enum）。（**3.00.1.11**）

## httpClient

### 功能优化

* 优化 `sendEmail` 函数的功能（**3.00.1.5**）：
  + 新增可选参数 *msg*，支持填入完整的邮件正文信息。
  + 将 *subject*, *body*
    参数改为可选，同时将通过这两个参数发送的邮件正文中的换行符修改为标准换行符。

## insight

### 故障修复

* 集群状态下，无法自动找到 insight 插件加密认证所需的 cert 文件。
* 订阅 orderTransaction 类型数据，出现错误的状态显示。

## Kafka

### 新功能

* 支持连接启用 SSL 认证的 Kafka Server。（**3.00.1.11**）
* 创建 consumer 与 producer 时增加异常回调机制。 （**3.00.1.4**）
* 新增 `getOffsetInfo` 函数，支持一键查询消费者偏移量信息。（**3.00.1.4**）

### 功能优化

* 优化 `createSubJob` 接收数据的性能，新增参数 *msgAsTable*，用于控制订阅的数据是否以表的形式返回。（**3.00.1.4**）
* 优化 `getJobStat` 函数，扩展返回的信息内容。 （**3.00.1.4**）
* 新增以纯字符串读写 Kafka 消息的功能。（**3.00.1.4**）
* 增加 producer、consumer 无法连接时的错误提示。（**3.00.1.4**）

### 兼容性

删除了原有冗余函数 30 余个，如果情况特殊需要用到之前函数，请联系技术支持获取带有全部函数的插件 txt 文件。（**3.00.1.4**）

## Kdb+

### 新功能

* 新增函数 `execute` ，可以通过 kdb+ 数据库执行 q 语句，获取数据到 DolphinDB 数据库。
  （**3.00.1.5**）
* 新增函数 `loadTableEx` 和 `loadFileEx` ，支持将 kdb+
  表格数据或磁盘数据导入 DolphinDB 数据库。（**3.00.1.5**）
* 新增函数 `extractTableSchema` 和
  `extractFileSchema` ，支持获取 kdb+ 表格数据文件或磁盘序列化文件的
  schema。（**3.00.1.5**）

## lgbm

首次发布，用于调用 LightGBM 库，对 DolphinDB 数据进行分类和回归。（**3.00.1.10**）

## LibTorch

### 新功能

* 支持模型预测结果为包含 tensor 的 tuple 。（**3.00.1.6**）
* 首次发布，用于在 DolphinDB 环境中使用 TorchScript 模型进行高效的模型预测和数据分析。（**3.00.1.1**）

## MDL

### 新功能

* 所有数据类型支持接收数据包元数据信息。（**3.00.1.13**）
* 接口 `createHandle` 和 `getSchema` 增加参数
  *options*，用于记录数据接收时间、插件处理时延。（**3.00.1.8**）
* 支持接收股票、期货市场的 L1 数据。（**3.00.1.2**）
* 增加 `getStatus` 函数用于查询具体数据品类的订阅信息。（**3.00.1.2**）

### 功能优化

* 提升了逐笔数据的接收处理效率。（**3.00.1.8**）
* order\_and\_transaction 类型（上交所 L2 和深交所 L2 的 order 和 transaction
  合并类型行情，接口 `getSchema`, `subscribe`,
  `unsubscribe`会用到）将 receivedTime 字段修改为
  NANOTIMESTAMP 类型。（**3.00.1.8**）

* 适配最新版本的订单簿引擎。（**3.00.1.5**）

### 故障修复

订阅逐笔合并数据时，跨天后日期不更新。（**3.00.1.5**）

## MongoDB

### 故障修复

* [DPLG-3303] MongoDB 的浮点数转换为 DolphinDB 整型时，结果错误。**（3.00.1.6）**
* [DPLG-3304] 在查询返回的数据里，若第一行的 oid 类型列的值为空，会导致 server 崩溃。**（3.00.1.6）**
* [DPLG-3312] 在查询数据时，若某列的前 1024 行都是空值，会导致 server 崩溃。**（3.00.1.6）**

## mqtt

### 新功能

* `mqtt::connect` 新增可选参数 *config*，支持以下设置
  + "recvBufSize"：接收缓冲区大小。（**3.00.1.1**）
  + "clientID"：指定发布连接的 ID。（**3.00.1.1**）
* `mqtt::subscribe` 新增可选参数 *config*，支持以下设置：
  + "sendBufSize"：设置发送缓冲区大小。（**3.00.1.1**）
  + "subscribeID"：指定订阅连接的 ID。（**3.00.1.1**）
  + "asyncFlag"：是否开启异步订阅模式。（**3.00.1.1**）

## NSQ

### 故障修复

* [DPLG-3392] 订阅 orderTrade 行情数据后无法取消订阅 order 或 trade
  类型数据。（**3.00.1.4**）
* [DPLG-3393] NSQ 插件触发自动重连后，重新接入数据导致宕机。（**3.00.1.4**）

## ODBC

### 功能优化

* Linux 版本插件支持根据 ODBC 驱动库接口，自动选择合适的字符编码驱动，支持了 SQLServer、SQLite
  的中文读取和写入。（**3.00.1.1**）

## OPC

### 功能优化

增强插件稳定性。（**3.00.1.10**）

### 缺陷修复

执行 `opc::close` 断开连接失败。（**3.00.1.10**）

## OPCUA

### 功能优化

* `subscribe` 新增参数 *reconnect* 和
  *resubscribeInterval*，支持在订阅断开时自动重连。（**3.00.1.10**）
* `subscribe` 函数新增参数
  *actionName*，可以指定订阅任务的名称。（**3.00.1.9**）

### 故障修复

* 在某些情况下，调用 `getSubscriberStat` 查看订阅状态导致 server
  宕机。（**3.00.1.9**）

## SevenZip

首次发布，支持压缩和解压缩多种格式文件。

## SSEQuotationFile

### 新功能

* `subscribe` 接口在订阅 mktdt04 行情文件时，新增 MktStatus 列和 MDTime 列，分别表示
  mktdt04 行情文件头中的交易状态信息和文件生成时间。（**3.00.1.4**）

### 功能优化

* 提升了解析文件的效率。（**3.00.1.8**）

## WindTDF

### 新功能

* `connect` 新增参数
  *replay*，用于设置在交易结束后是否回放当天的所有数据。（**3.00.1.1**）

## WebSocket

### 功能改进

* 在打印日志中输出订阅标识（tag）。（**3.00.1.2**）

### 故障修复

* WebSocket 插件重连失败，导致 server 宕机。（**3.00.1.8**）
* 当 `cancelSubJob` 取消任务的执行时间超过 5 秒 时，任务还在取消中，却返回了
  false。（**3.00.1.2**）

## zip

### 故障修复

* 当解压的目标文件夹没有写权限时，解压没有抛出异常。（**3.00.1.4**）

